import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getDatabase, ref, set, query, orderByChild, equalTo, get } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";
document.getElementById('HTML11_Subscriber').innerHTML +=`<style>#MyTiktok .popup .popup-content::-webkit-scrollbar-thumb {background: var(--linkB)}.popup.hidden{display:none}#MyTiktok .css-1editg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-padding-start:24px;padding-inline-start:24px;-webkit-padding-end:24px;padding-inline-end:24px}#MyTiktok .css-1e17bzi{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}#MyTiktok #profile{display:flex;flex-wrap:wrap;align-items:center;gap:20px;margin:20px}#MyTiktok #profile img{width:100px;height:100px;border-radius:50%}#MyTiktok #profile #profile-info{flex:1}#MyTiktok #profile #profile-info h2{font-size:24px;margin:0}#MyTiktok #profile #profile-info p{margin:5px 0;font-size:14px}#MyTiktok .follow-btn,.css-ug6w5y{background:#ff3b5c;color:#fff;border:none;padding:10px 20px;border-radius:5px;cursor:pointer;font-size:14px;margin-top:10px}#MyTiktok .follow-btn:hover{background:#ff4d6f}#MyTiktok #video-gallery{display:grid;grid-template-columns:repeat(auto-fit,minmax(80px,1fr));gap:10px;padding:10px}#MyTiktok #video-gallery .video{border-radius:7px;position:relative;overflow:hidden;aspect-ratio:1/1;cursor:pointer}#MyTiktok #video-gallery .video img{width:100%;height:100%;object-fit:cover}#MyTiktok #video-gallery .video .info{position:absolute;bottom:0;left:0;width:100%;background:rgba(0,0,0,.7);color:#fff;font-size:12px;text-align:left;padding:5px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}#MyTiktok #video-gallery .video .play-count{display:flex;position:absolute;top:5px;right:5px;background:rgba(0,0,0,.6);color:#fff;font-size:10px;padding:3px 6px;border-radius:12px;font-weight:700}#MyTiktok #video-gallery .video .play-count svg{fill:#fff;height:10px;width:10px;margin-right:5px}#MyTiktok .popup{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.8);display:flex;justify-content:center;align-items:center;z-index:1000;opacity:0;pointer-events:none;transition:opacity .3s}#MyTiktok .popup.active{opacity:1;pointer-events:auto}#MyTiktok .popup .popup-content{display:flex;flex-direction:column;gap:20px;width:90vw;height:95%;overflow-y:auto;overflow-x:hidden;background:#000;border-radius:8px;padding:10px}#MyTiktok .popup .iframe-container{flex:0 0 auto;width:100%;max-width:100%;max-height:576px;display:flex;justify-content:center;align-items:center}#MyTiktok .popup .iframe-container iframe{max-width:100%;max-height:100%;border:none;border-radius:8px}@media (max-width:480px){#MyTiktok .popup .iframe-container{max-height:100%;max-width:100%}}#MyTiktok .close-btn{position:absolute;top:10px;right:20px;background:0 0;border:none;font-size:24px;color:red;cursor:pointer}@media (max-width:768px){#MyTiktok .popup .iframe-container{height:90vh;padding:0;max-width:100%}#MyTiktok .popup .iframe-container iframe{border-radius:0}#MyTiktok #profile img{width:80px;height:80px}#MyTiktok #profile #profile-info h2{font-size:20px}#MyTiktok #profile #profile-info p{font-size:12px}#MyTiktok #video-gallery{grid-template-columns:repeat(auto-fit,minmax(120px,1fr))}#MyTiktok .popup .popup-content{width:100%;max-height:100%}}#SubscriberForm{max-width:400px;margin:auto;padding:20px;border:1px solid #ddd;border-radius:8px;background-color:var(--contentB);box-shadow:0 4px 8px rgba(0,0,0,.1);font-family:Arial,sans-serif}#SubscriberForm .subscribe-widget h2{font-size:18px;margin-bottom:15px;text-align:center}#SubscriberForm .form-group{margin-bottom:15px;text-align:left}#SubscriberForm .form-group label{font-size:14px;margin-bottom:5px;display:block}#SubscriberForm .form-group input{width:100%;padding:10px;border:1px solid #ccc;border-radius:4px;font-size:14px;outline:0}#SubscriberForm .form-group input:focus{border-color:#007bff;box-shadow:0 0 4px rgba(0,123,255,.2)}#SubscriberForm .btn-submit,#SubscriberForm .popup .close-btn{background-color:var(--linkB);color:#fff;padding:10px 20px;font-size:16px;border:none;border-radius:4px;cursor:pointer;width:100%}#SubscriberForm .btn-submit:hover{opacity:.8}#SubscriberForm .popup{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);padding:20px;border-radius:8px;background-color:var(--contentB);box-shadow:0 4px 8px rgba(0,0,0,.2);text-align:center;display:none;z-index:1000}#SubscriberForm .popup.success{border:2px solid #28a745;color:#28a745}#SubscriberForm .popup.error{border:2px solid #dc3545;color:#dc3545}#SubscriberForm .overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);z-index:999;display:none} .drK #SubscriberForm, .drK #SubscriberForm input,.drK #SubscriberForm label,.drK #SubscriberForm h2 { background: var(--darkBa); color: var(--darkT);}.drK #SubscriberForm .popup{background: var(--darkBa)}</style><div id="SubscriberForm"> <div class="subscribe-widget"> <h2>Get New Articles via Email</h2> <form id="subscribeForm"><div class="form-group"><input type="email" id="email" name="email" placeholder="Contoh: nama@mail.com" required> </div> <button type="submit" class="btn-submit">Subscribe</button> </form> </div><div class="overlay" id="overlay"></div> <div class="popup" id="popup"> <p id="popupMessage"></p> <button class="close-btn" id="closePopup">Tutup</button> </div> </div>`;
  // Konfigurasi Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyCDqLMbqjfPh-E2w-8gWZOMoKqFOJY8DpU",
    authDomain: "subscribesabda.firebaseapp.com",
    databaseURL: "https://subscribesabda-default-rtdb.firebaseio.com",
    projectId: "subscribesabda",
    storageBucket: "subscribesabda.firebasestorage.app",
    messagingSenderId: "1002892047780",
    appId: "1:1002892047780:web:7b660571cdb99edf38fd31"
  };

  // Inisialisasi Firebase
const app = initializeApp(firebaseConfig);
const database = getDatabase(app);
const form = document.getElementById('subscribeForm');
const popup = document.getElementById('popup');
const overlay = document.getElementById('overlay');
const popupMessage = document.getElementById('popupMessage');
form.addEventListener("submit",async e=>{e.preventDefault();let a=document.getElementById("email").value,t=document.getElementById("email").value.toLowerCase();try{let r=query(ref(database,"subscribers"),orderByChild("email"),equalTo(t)),s=await get(r);if(s.exists()){showPopup("Email sudah terdaftar.","error"),form.reset();return}let i=Date.now().toString();await set(ref(database,"subscribers/"+i),{nama:a,email:t}),showPopup("Sukses! Terima kasih telah berlangganan.","success"),form.reset()}catch(l){showPopup("Terjadi kesalahan. Silakan coba lagi.","error")}});document.getElementById('closePopup').addEventListener('click', function () {popup.style.display = 'none';overlay.style.display = 'none'});function showPopup(message, type) {popupMessage.textContent = message;popup.className=`popup ${type}`;popup.style.display = 'block';overlay.style.display = 'block';};
!function(){let e=document.getElementById("username"),t=document.getElementById("description"),a=document.getElementById("profile-picture"),i=document.getElementById("stats"),l=document.getElementById("video-gallery"),d=document.getElementById("popup"),r=document.getElementById("popup-content"),n=d.querySelector(".close-btn"),s=null;function o(e,t=50){return e?e.length>t?e.slice(0,t)+"...":e:""}async function c(){try{let n=await (await fetch("https://sabdaliterasi.xyz/api/tiktok.json")).json(),c=n.source.data["/embed/@sabdaliterasipalu?lang=id"].userInfo,p=n.source.data["/embed/@sabdaliterasipalu?lang=id"].videoList;e.textContent="@"+c.uniqueId,t.textContent=c.signature||"Tidak ada deskripsi.",a.src=c.avatarThumbUrl||"https://via.placeholder.com/150",i.textContent=`Followers: ${"1"+c.followerCount} â€¢ Likes: ${c.heartCount||0}`,l.innerHTML="",r.innerHTML="",p.forEach((e,t)=>{let a=`https://sabdaliterasi.xyz/api/embed-video-tiktok/${e.id}`,i=e.coverUrl||"https://via.placeholder.com/200",n=document.createElement("div");n.classList.add("video");let s=document.createElement("img");s.src=i,s.alt=o(e.desc,50);let c=document.createElement("div");c.classList.add("info"),c.textContent=o(e.desc,50);let p=document.createElement("div");p.classList.add("play-count"),p.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="#fff" viewBox="0 0 24 24"><path d="M3 22v-20l18 10-18 10z"/></svg>    ${e.playCount||0}`,n.appendChild(s),n.appendChild(c),n.appendChild(p),n.addEventListener("click",()=>{var e;let a,i,l,n,s;return e=t,d.classList.add("active"),d.classList.remove("hidden"),a=r.querySelectorAll(".iframe-container"),i=a[e]?.querySelector("iframe"),i&&i.dataset.src&&(i.src=i.dataset.src),l=a[e].offsetTop,n=r.clientHeight,s=a[e].clientHeight,void r.scrollTo({top:l-n/2+s/2,behavior:"smooth"})}),l.appendChild(n);let h=document.createElement("div");h.classList.add("iframe-container");let m=document.createElement("iframe");m.classList.add("MyVideoIfr"),m.setAttribute("data-src",a),m.setAttribute("loading","lazy"),m.frameBorder="0",m.width=e.width,m.height=e.height,h.appendChild(m),r.appendChild(h)});let h=`https://www.tiktok.com/@${c.uniqueId}`;document.getElementById("follow-btn").addEventListener("click",()=>{window.open(h,"_blank")}),s&&s.disconnect(),s=new IntersectionObserver(e=>{e.forEach(e=>{let t=e.target;if(!e.isIntersecting){let a=t.dataset.src;t.src="",setTimeout(()=>{t.src=a},100)}})},{root:r,rootMargin:"0px",threshold:.2}),r.querySelectorAll("iframe").forEach(e=>s.observe(e));document.getElementById("quotesTK").remove();document.getElementById("MyTiktok").classList.remove("hidden")}catch(m){console.error("Failed to fetch JSON feed:",m),l.innerHTML="<p>Gagal memuat video. Coba lagi nanti.</p>"}}n.addEventListener("click",()=>{d.classList.remove("active"),d.classList.add("hidden");r.querySelectorAll("iframe.MyVideoIfr").forEach(e=>{e.src=""})}),d.addEventListener("click",e=>{e.target===d&&d.classList.remove("active"),d.classList.add("hidden")}),c()}();
