---
layout: null
permalink: /ujifile/sendmail/
---
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Formulir Penyimpanan Real-time Firebase</title>
<link href="/wp-conten/file/cdn/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"><script async src="/wp-conten/file/cdn/gh/ajax-jquery/sabdaliterasi.shop@master/ujifile/MyFoto.min.js"></script>
<script src="/assets/js/jquery-3.7.1.min.js"></script>
<script src="/assets/js/editartikel.min.js"></script>
<style>.hidden{display:none}#lihatkontak svg,#tambah svg{fill:#0d6efd;width:24px}div#hasil{background:#000;font-size:14px;padding:13px 15px;width:100%;height:auto;font-family:monospace;line-height:.9rem}button.btn[data-toggle=collapse]{display:-webkit-inline-box;width:100%;margin-right:auto}input.mykontaksend{margin-right:5px}
</style>
</head>
<body>
<div class="container">
<h1 class="text-center mb-4">Send Email via API</h1>
<form id="emailForm">
<div class="mb-3 field">
<label for="subject" class="form-label">Judul:</label>
<input type="text" id="subject" class="form-control" name="subject" required>
</div>

<div class="mb-3 field">
<label for="attachment2" class="form-label">Tulisan:</label>
<input accept=".doc, .docx" type="file" id="attachment2" class="form-control" name="attachment2" required>
</div>

<div class="mb-3 field">
<label for="EmailSaya" class="form-label">Pengirim:</label>
<select class="form-select" id="EmailSaya" aria-label="Example select with button addon">
    <option value="fadhelfikri93@gmail.com" selected>fadhelfikri93@gmail.com</option>
    <option value="fadhel13fikri@gmail.com" selected>fadhel13fikri@gmail.com</option>
    <option value="fadhelfikri@yahoo.com">fadhelfikri@yahoo.com</option>
    <option value="fadhelfikri98@gmail.com">fadhelfikri98@gmail.com</option>
    <option value="martinamulia04@gmail.com">martinamulia04@gmail.com</option>
  </select>
</div>

<div class="form-check form-check-inline">
<input class="form-check-input" type="checkbox" id="uploadfotoku" name="uploadfotoku" value="true">
<label class="form-check-label" for="uploadfotoku">
Upload Foto
</label>
</div>

<div class="form-check form-check-inline">
<input class="form-check-input" type="checkbox" id="Tulis_Konten" name="Tulis_Konten" value="true">
<label class="form-check-label" for="Tulis_Konten">
Tulis Konten
</label>
</div>

<div id="tulis_konten" class="hidden">
<div id="validck" class="form-outline mb-2 CKeditnya">
<textarea name="editor" class="form-control" id="editor" rows="4" placeholder="editor"></textarea>
</div>
<div class="mb-3 field">
<button class="btn btn-primary" id="cetak">Download</button>
</div>
</div>

<div class="mb-3 field uploadfotoku hidden">
<label for="attachment1" class="form-label">Foto:</label>
<input accept="image/*" type="file" id="attachment1" class="form-control" name="attachment1">
</div>
<div class="mb-3 field">
<input type="submit" value="Send Email" class="btn btn-primary">
</div>
</form>
<div class="mb-3 field">
Jumlah berhasil: <span id="targetsukses">0</span>/<span id="target">0</span> | Jumlah Cheked: <span id="jumlahcheked">0</span>
</div>
<div class="mb-3 field">
<div id="hasil" class="hidden"></div>
</div>
<div class="card-header py-3"><input class="hidden" type="checkbox" id="chekkon" name="chekkon"><h5 class="mb-0"><label role="button" for="chekkon">Contak(<span id="jumlahkontak">0</span>)
<span id="lihatkontak"><svg viewBox="0 0 24 24"><path d="m16.843 10.211c.108-.141.157-.3.157-.456 0-.389-.306-.755-.749-.755h-8.501c-.445 0-.75.367-.75.755 0 .157.05.316.159.457 1.203 1.554 3.252 4.199 4.258 5.498.142.184.36.29.592.29.23 0 .449-.107.591-.291 1.002-1.299 3.044-3.945 4.243-5.498z" /></svg></span></label>
<span id="tambah" role="button"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m21 3.998c0-.478-.379-1-1-1h-16c-.62 0-1 .519-1 1v16c0 .621.52 1 1 1h16c.478 0 1-.379 1-1zm-9.75 7.252v-3.5c0-.414.336-.75.75-.75s.75.336.75.75v3.5h3.5c.414 0 .75.336.75.75s-.336.75-.75.75h-3.5v3.5c0 .414-.336.75-.75.75s-.75-.336-.75-.75v-3.5h-3.5c-.414 0-.75-.336-.75-.75s.336-.75.75-.75z" /></svg></span>
</h5> </div>
<div class="mb-3 field"><form id="myForm" class="hidden">
<div class="card-header"><h5 class="mb-0">tambah kontak</h5></div>
<div class="input-group mb-3">
<input type="text" id="namaWebsite" name="namaWebsite" class="form-control" placeholder="Nama" required>
<input class="form-control" placeholder="Email" type="email" id="email" name="email" required>
</div>
<div class="input-group mb-3">
<input type="url" id="website" class="form-control" placeholder="Website" name="website" required>
<input type="text" id="subyek" name="subyek" class="form-control" placeholder="Subyek" required>
</div>
<div class="form-check">
<input class="form-check-input" type="checkbox" id="bodyCheckbox" name="body" value="true">
<label class="form-check-label" for="bodyCheckbox">
Body Email
</label>
</div>
<button type="submit" class="btn btn-primary">Submit</button>
</form></div>
<div id="Kontaksave" class="mb-3 field hidden"><ul id="websiteList" class="list-group"></ul></div>
</div>
<script src="/wp-conten/file/cdn/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="/wp-conten/file/cdn/npm/jszip@3.7.1/dist/jszip.min.js"></script>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
  import { getDatabase, ref, set, get, remove } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js";
   const firebaseConfig = {
    apiKey: "AIzaSyAFuoVF8LkEtVHtd33A0FJHIyIOhDzGbjA",
    authDomain: "sabaliterasipalu.firebaseapp.com",
    databaseURL: "https://sabaliterasipalu-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "sabaliterasipalu",
    storageBucket: "sabaliterasipalu.appspot.com",
    messagingSenderId: "567229920099",
    appId: "1:567229920099:web:636ca97b7ee332b342d956",
    measurementId: "G-7W6SD9QBY7"
  };
const app = initializeApp(firebaseConfig);
const database = getDatabase(app);
let stopped = false;

$("input#uploadfotoku").on('change',function(){
  $("div.uploadfotoku").slideToggle();
});
$("span#tambah").click(function(){
  $("form#myForm").slideToggle();
});
$("input#chekkon").click(function(){
  $("#Kontaksave").slideToggle();
});
$("input#Tulis_Konten").click(function(){
  $("#tulis_konten").slideToggle();
});
function LinkToBase64(url, onSuccess) {
    fetch(url)
        .then(response => response.blob())
        .then(blob => {
            const reader = new FileReader();
            reader.onloadend = () => {
                const base64String = reader.result.split(",")[1];
                onSuccess(base64String);
            };
            reader.readAsDataURL(blob);
        })
        .catch(error => {
            console.error("Error converting image to base64:", error);
            alert("gagal kirim gambar");
        });
}




document.getElementById('emailForm').addEventListener('submit', async function(event) {
    event.preventDefault();
    stopped = false;
var isValid = $('.mykontaksend:checked').length;
let mail = $("#EmailSaya").val(),imageUrl = "/wp-conten/file/cdn/gh/ajax-jquery/asset.sabdaliterasi.shop@main/img/Fadhel-Fikri.png";if(mail === "martinamulia04@gmail.com"){imageUrl = "/wp-conten/file/cdn/gh/ajax-jquery/asset.sabdaliterasi.shop@main/img/Martina-Mulia-Dewi.png"}


if(isValid > 0){ 

LinkToBase64(imageUrl, function(base64String) {

$("#targetsukses").text("0");$("#target").text("0");$("#hasil").slideDown().html("");
let tujuan =[]
 $('input.mykontaksend').each(function () {
      var checkbox = $(this);
      var isChecked = checkbox.is(':checked');
      
      // Jika checkbox dicentang, tambahkan nilai dari value atribut ke array jsonArray
      if (isChecked) {
        var value =JSON.parse(checkbox.val());
        tujuan.push(value);
      }
    });
kirimSemuaEmail(tujuan,base64String);


});




}
else{
alert("Anda harus memilih setidaknya satu item.");
}


});
async function kirimSemuaEmail(tujuan,myfotoku) {
    const data = tujuan;
    document.getElementById('target').innerHTML=data.length;
    for (let i = 0; i < data.length; i++) {
        const item = data[i];
        try {
            await kirim(item.email, item.nama, item.website, item.subyek,item.body,myfotoku);
            if (stopped) {
                break;
            }
        } catch (error) {
            console.error('Error:', error);
            stopped = true; // Set stopped menjadi true jika terjadi kesalahan
            break;
        }
    }
    
}
async function kirim(email, media, website, subyek,body,myfotoku) {


let mail = $("#EmailSaya").val(),
nama = "Fadhel Fikri",
atribusi="Co-Founder di Sophia Insitute dan pegian filsafat dan Sains.",inforek="(Jika Dibutuhkan) No REK SeaBank/Bank Kesejahteraan Ekonomi (BKE):<br>901409177061 (an. Moh Fadhel Fikri)";
if(mail === "martinamulia04@gmail.com"){
nama="Martina Mulia Dewi",
atribusi="Lifelong Learner, content writer, recipe writer, blogger, and feminist activist.",
inforek=""
}

function replacename(n) {return n.toLowerCase().replaceAll(" ","-")}
const senderName = nama;
    const judul = $('#subject').val();
    const recipientEmail = email;
    const subject = subyek.replaceAll("JUDULNYA", judul).replaceAll("NAMAKU", nama);
   let file1 = document.getElementById('attachment1').files[0];
    let file2 = document.getElementById('attachment2').files[0];
            
    let attachment1 = myfotoku;
    let Nameattachment1 = replacename(nama)+".png";
    if(file1){
var url = file1.name,parts = url.split("."),extension = parts[parts.length - 1];
attachment1 = await fileToBase64(file1);
Nameattachment1 =replacename(nama)+"."+extension;
    }
            
    const attachment2 = await fileToBase64(file2);
    const Nameattachment2 = file2.name;
    
    let badan="",lampirkan="lampirkan",bb="";
    if(body==true){
    badan = await extractDocxContent(file2),lampirkan="tulis (copy paste dari word ke badan email) di bawah biodata saya",bb=',"body":true'
    }
    const message = `<p>Assalamualaikum.. saya mau kirim tulisan kak, untuk di terbitkan di ${media} (${website}). Judul tulisan saya yaitu "${judul}". Filenya telah saya ${lampirkan}.</p><p>DISCLAIMER: TULISAN YANG SAYA KIRIM BERSIFAT ORISINAL, HASIL KARYA SAYA (${nama}).</p><p>Dan ini biodata Saya:<br>Nama Penulis: ${nama}</p><p>Atribusi/Deskripsi:<br>${atribusi} Dan pembisnis di Sabda Literasi Palu(https://sabdaliterasi.xyz)</p><p>Website:<br>https://sabdaliterasi.xyz</p><p>No Hp/Wa:<br>{{ site.wa }}</p><p>Email:<br>${mail}</p><p>Foto Penulis:<br>Terlampir</p><p>${inforek}</p>${badan}`;
    
    

    const data = { 
        mail, 
        nama,
        recipientEmail, 
        subject, 
        message, 
        attachment1, 
        attachment2,
        Nameattachment1,
        Nameattachment2 
    };

    var hasil = document.getElementById('hasil');
    let listItem="";
     const js={
     		"from":`"${nama}" <${mail}>`,
            "nama": media,
            "email": recipientEmail,
            "website": website,
            "subyek": subject,
            "body":body
        };

    try {
        const response = await fetch('/wp-conten/api/v1/send-email', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
        });

        if (!response.ok) {
            throw new Error('Failed to send email');
        }

        const result = await response.text();
        console.log('Email sent:', result);$("div#hasil").attr("style","color:#00ff14");
        listItem+= `"SUKSES":${JSON.stringify(js,null,2)}`;var jumlahtarget=document.getElementById('targetsukses');
        jumlahtarget.innerText=parseInt(jumlahtarget.innerText)+1
    } catch (error) {
        console.error('Error:', error);$("div#hasil").attr("style","color:red");
         listItem+= `"ERROR":${JSON.stringify(js,null,2)}`;
        stopped = true;
    }
$("div#hasil").slideDown();
    hasil.innerText=listItem;   
}
async function fileToBase64(file) {
    if (!file) return null;

    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result.split(',')[1]);
        reader.onerror = error => reject(error);
        reader.readAsDataURL(file);
    });
}
function extractDocxContent(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();

    reader.onload = async function(event) {
      const arrayBuffer = event.target.result;
      const uint8Array = new Uint8Array(arrayBuffer);
      const content = await extractTextFromDocx(uint8Array);
      resolve(content);
    };

    reader.onerror = function(event) {
      reject(new Error('Failed to read the file'));
    };

    reader.readAsArrayBuffer(file);
  });
}
async function extractTextFromDocx(arrayBuffer) {
  const zip = await JSZip.loadAsync(arrayBuffer);
  const contentXml = await zip.file('word/document.xml').async('string');
  const parser = new DOMParser();
  const xmlDoc = parser.parseFromString(contentXml, 'text/xml');

  let text = '';

  const paragraphs = xmlDoc.getElementsByTagName('w:p');
  for (let i = 0; i < paragraphs.length; i++) {
    const paragraph = paragraphs[i];
    const textNodes = paragraph.getElementsByTagName('w:t');
    let paragraphText = '';
    for (let j = 0; j < textNodes.length; j++) {
      paragraphText += textNodes[j].textContent;
    }

    const bold = paragraph.getElementsByTagName('w:b').length > 0;
    const br = paragraph.getElementsByTagName('br').length > 0;
    const italic = paragraph.getElementsByTagName('w:i').length > 0;
    const underline = paragraph.getElementsByTagName('w:u').length > 0;
    const heading1 = paragraph.getElementsByTagName('w:pStyle')[0]?.getAttribute('w:val') === 'Heading1';
    const heading2 = paragraph.getElementsByTagName('w:pStyle')[0]?.getAttribute('w:val') === 'Heading2';

    if (bold) paragraphText = '<strong>' + paragraphText + '</strong>';
    if (br) paragraphText = paragraphText.replaceAll(br,"<br>");
    if (italic) paragraphText = '<em>' + paragraphText + '</em>';
    if (underline) paragraphText = '<u>' + paragraphText + '</u>';
    if (heading1) paragraphText = '<h1>' + paragraphText + '</h1>';
    if (heading2) paragraphText = '<h2>' + paragraphText + '</h2>';

    // Menambahkan setiap paragraf dengan tag <p> HTML
    text += '<p>' + paragraphText + '</p>';
  };
let mail = $("#EmailSaya").val(),
mybio="BIO SAYA:Nama Penulis: Fadhel Fikri Atribusi/Deskripsi: Co-Founder di Sophia Insitute dan pegian filsafat dan Sains. Dan pembisnis di Sabda Literasi PaluWebsite:https://sabdaliterasi.xyzNo Hp/Wa: {{ site.wa }} Email:fadhel13fikri@gmail.comFoto Penulis:Terlampir(Jika Dibutuhkan) No REK SeaBank/Bank Kesejahteraan Ekonomi (BKE): 901409177061 (an. Moh Fadhel Fikri)";
if(mail === "martinamulia04@gmail.com"){
mybio="BIO SAYA:Nama Penulis: Martina Mulia DewiAtribusi/Deskripsi: Lifelong Learner, content writer, recipe writer, blogger, and feminist activist. Dan pembisnis di Sabda Literasi PaluWebsite:https://sabdaliterasi.xyzNo Hp/Wa: {{ site.wa }} Email:martinamulia04@gmail.comFoto Penulis:Terlampir"}

  return text.replace(mybio,"");
}
function getDataFromFirebase() {
    const websiteList = document.getElementById('websiteList');
    
    websiteList.innerHTML = '';

    // Gunakan fungsi get() untuk mengambil data dari Firebase
    get(ref(database, 'MyContact'))
      .then((snapshot) => {
        if (snapshot.exists()) {
        
        let listItem=`<li class="list-group-item" id="checkAllList"><input type="checkbox" id="checkAll"> 
        <label for="checkAll">Check All</label></li>`;
        
        let total = 0;
          snapshot.forEach((childSnapshot) => {
         
            const website = childSnapshot.val();
            
            let namakontak=childSnapshot.key
            // Buat elemen list untuk setiap website
            
            listItem+=`
            <li class="list-group-item" id="${namakontak}">
    
      <div class="d-flex  justify-content-between align-items-center">
      
        
        
          <input type="checkbox" class="custom-control-input mykontaksend" id="${namakontak}-chekbox" name="${namakontak}" value='${JSON.stringify(website)}'>
          <label class="custom-control-label" for="${namakontak}-chekbox"></label>
          
        
        <button class="btn" type="button" data-toggle="collapse" data-target="#${namakontak}-info" aria-expanded="false" aria-controls="collapseItem1">
          ${namakontak.replaceAll("-",".")}
        </button><button class="btn" id="removekontak" type="button" data-kontak="${namakontak}">X</button>
      </div>
      <div class="collapse" id="${namakontak}-info">
        <div class="list-group-item">
          <strong>Nama Website:</strong> ${website.nama}<br>
              <strong>Email:</strong> ${website.email}<br>
              <strong>Subyek:</strong> ${website.subyek}<br>
              <strong>Website:</strong> <a href="${website.website}" target="_blank">${website.website}</a><br>
              <strong>Body:</strong> ${website.body}<br>
              <br>
        </div>
      </div>
      
    </li>
    
              
            `;total++
           
          
       }); $("#jumlahkontak").text(total);
           websiteList.innerHTML=listItem;
          chekboxkui()
        } else {
          console.log("No data available");
        }
      })
      .catch((error) => {
        console.error("Error getting data:", error);
      });
  }getDataFromFirebase();
document.getElementById("myForm").addEventListener("submit", function(event) {
    event.preventDefault(); // Hindari pengiriman formulir secara langsung
    
    // Dapatkan nilai-nilai input
    const namaWebsite = document.getElementById("namaWebsite").value;
    const email = document.getElementById("email").value;
    const website = document.getElementById("website").value;
    const subyek = document.getElementById("subyek").value;
    const body = document.getElementById("bodyCheckbox").checked;
    
    // Simpan data ke Firebase Realtime Database dengan menggunakan set()
     function namauri(url) {
  // Ekspresi reguler untuk mencocokkan nama domain tanpa TLD
  const regex = /^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:\/\n?]+)/g;
  const match = regex.exec(url);
  if (match && match[1]) {
    return match[1];
  } else {
    return null; // Jika tidak ada kecocokan ditemukan
  }
} 
    
    set(ref(database, "MyContact/" +namauri(website.replaceAll(".","-"))), {
      nama: namaWebsite,
      email: email,
      website: website,
      subyek: subyek,
      body: body
    })
    .then(() => {
      document.getElementById("myForm").reset();
      // Ambil data terbaru dari Firebase setelah disimpan
      getDataFromFirebase();
    })
    .catch(error => {
      console.error("Error menyimpan data: ", error);
      alert("Terjadi kesalahan. Silakan coba lagi.");
    });
  });
function chekboxkui(){
         function deleteDataFromFirebase(websiteKey) {
  
  const dataRef = ref(database, "MyContact/"+websiteKey);
  
  // Gunakan metode remove() untuk menghapus data
  remove(dataRef)
    .then(() => {
      alert("Data berhasil dihapus"); getDataFromFirebase();$("#"+websiteKey).remove()
    })
    .catch((error) => {
      console.error("Error removing data: ", error);
    });
}
           $('button#removekontak').on('click', function () {  
           
           var k = $(this).attr("data-kontak");
           if(confirm("ingin menghapu "+k.replaceAll('-','.')+"?")){
           
           deleteDataFromFirebase(k)
           
           }
           
           }); 
           $(function(){$('#checkAll').change(function(){if($(this).is(':checked')){$('.mykontaksend').prop('checked',true);}else{$('.mykontaksend').prop('checked',false);}});});
           
           $('#websiteList li input[type=checkbox]').change(function() {
setTimeout(function(){ var jumlahTercentang = $('#websiteList li input.mykontaksend:checked').length;
 $('span#jumlahcheked').text(jumlahTercentang);
 },0)
    });
           }
           
         function openCK(){ClassicEditor.create(document.getElementById("editor"), {
heading: { options: [ { model: 'paragraph', title: 'Paragraph', class: 'ck-heading_paragraph' }, { model: 'heading2', view: 'h2', title: 'H2', class: 'ck-heading_heading2' }, { model: 'heading3', view: 'h3', title: 'H3', class: 'ck-heading_heading3' }, { model: 'heading4', view: 'h4', title: 'H4', class: 'ck-heading_heading4' }, { model: 'heading5', view: 'h5', title: 'H5', class: 'ck-heading_heading5' }, { model: 'heading6', view: 'h6', title: 'H6', class: 'ck-heading_heading6' } ] }
});}openCK()

function CKdata(){
let u = document.querySelector('.ck-editor__editable'),
   e = u.ckeditorInstance.getData().trim();
   return e
}  

!function(){

    document.addEventListener( 'DOMContentLoaded', () => {
			const submitButton = document.getElementById( 'cetak' );

			submitButton.addEventListener( 'click', event => {
				event.preventDefault();
if($('#subject').val()==""){
$('#subject').focus();
return false
}else{createAndDownloadDocx()};
			} );
		
        
        } );
        
        
    
		const DEFAULT_HEADERS = {
			'x-cs-app-id': 'cs-docx-demo'
		};

		
let tokenEndpoint="";
		function createAndDownloadDocx() {
        
  
const formEl = document.getElementById( 'create-docx-form' );
			const formData = [ ...new FormData( formEl ) ];
             function mdfile(){ 
 var coo=Judul;
return coo.toLowerCase().replace(/[^a-zA-Z0-9]+/g, '-').replace(/--+/g, '-').replace(/^-+|-+$/g, '')
};
            
            let isi=CKdata(),Judul=$('#subject').val(),nama=mdfile();
           
 let mail = $("#EmailSaya").val(),
namaku = "Fadhel Fikri",
atribusi="Co-Founder di Sophia Insitute dan pegian filsafat dan Sains.",inforek="<i>(Jika Dibutuhkan)</i><strong> No REK SeaBank/Bank Kesejahteraan Ekonomi (BKE):</strong><br> 901409177061 (an. Moh Fadhel)";
if(mail === "martinamulia04@gmail.com"){
namaku="Martina Mulia Dewi",
atribusi="Lifelong Learner, content writer, recipe writer, blogger, and feminist activist.",
inforek=""
}

			const request = {
            "options":
            {
            "auto_pagination":true,
            "header":[],
            "footer":[],
            "margin_top":"4cm",
            "margin_right":"3cm",
            "margin_bottom":"3cm",
            "margin_left":"4cm",
            "format":"A4",
            "orientation":"portrait",
            "base_url":""},
            "html":`<h1>${Judul}</h1>${isi}<br><br><br> <strong>BIO SAYA:</strong><br><strong>Nama Penulis: </strong>${namaku}<br><br> <strong>Atribusi/Deskripsi:</strong><br> ${atribusi} Dan pembisnis di <a href="https://sabdaliterasi.xyz">Sabda Literasi Palu</a> <br><br> <strong>Website:</strong><br> <a href="https://sabdaliterasi.xyz">https://sabdaliterasi.xyz</a> <br><br> <strong>No Hp/Wa:</strong><br> {{ site.wa }} <br><br> <strong>Email:</strong><br><a href="mailto:${mail}">${mail}</a> <br><br> <strong>Foto Penulis:</strong><br> <i>Terlampir</i> <br><br>${inforek}
`,
            "css":"h2{font-weight:bold}h2,p{text-align:justify;font-size: 16px;}h1{text-align: center;font-size: 18px;font-weight:bold}p#bio{text-align:justify;text-align:left;}"
            };

			createHeaders( tokenEndpoint )
				.then( headers => fetch( 'https://docx-converter.cke-cs.com/v1/convert', { method: 'POST', body: JSON.stringify( request ), headers } ) )
				.then( res => {
					if ( res.status === 400 ) {
						alert( 'An error occurred during conversion. Please check all the inputs.' );

						return null;
					}

					if ( res.status > 299 ) {
						alert( 'An error occurred during conversion.' );

						return null;
					}
					return res.blob();
				} )
				.then( blob => {
					if ( !blob ) {
						return;
					}

					const link = document.createElement( 'a' );
					link.href = window.URL.createObjectURL( blob );
					link.download = `${namaku}-${nama}.docx`;
					link.click();
				} );
		}

		function createHeaders( tokenEndpoint ) {
			if ( tokenEndpoint ) {
				return fetch( tokenEndpoint, { method: 'GET' } )
					.then( res => res.text() )
					.then( token => {
						return { ...DEFAULT_HEADERS, Authorization: token }
					} );
			}

			return Promise.resolve( DEFAULT_HEADERS );
		}

		function processMargin( request, fieldName, fieldValue ) {
			if ( !fieldName.endsWith( '_unit' ) ) {
				request.options[ fieldName ] = request.options[ fieldName ] ? fieldValue.concat( '', request.options[ fieldName ] ) : fieldValue;

				return;
			}

			const marginField = fieldName.replace( '_unit', '' );

			request.options[ marginField ] = request.options[ marginField ] ? request.options[ marginField ].concat( '', fieldValue ) : fieldValue;
		}

		function mapHeadersOrFootersToList( element ) {
			return Object.keys( element ).filter( type => !!element[ type ].html ).map( type => ( {
				type,
				css: element[ type ].css,
				html: element[ type ].html,
			} ) )
		}
	}()
</script><form class="hidden" id="create-docx-form"></form>
</body>
</html>
