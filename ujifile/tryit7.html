---
layout: null
permalink: /wp-admin/tryit7
---
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Editor</title>
    <link rel="stylesheet" href="https://sabdaliterasi.xyz/wp-content/cdn/n/bootstrap/5.3.2/dist/css/bootstrap.min.css">
  <script src="https://sabdaliterasi.xyz/wp-content/cdn/n/jquery/3.7.1/dist/jquery.min.js"></script>
<script src="https://sabdaliterasi.xyz/wp-content/cdn/g/ajax-jquery/sabdaliterasi.shop/file/ujifile/file/tryit/codemirror6.min.js"></script>
    
    <style>
        body { margin: 0; padding: 0; }
/* Pastikan toolbar tidak terlalu ke atas */
.toolbar-container {
    max-width: 50%;
    top: 30%;
    right: 0px;
    position: fixed;
    background: rgba(0, 0, 0, 0.8);
    border-radius: 10px;
    padding: 10px;
    z-index: 9999;
  display:none
}

/* Styling tombol toggle agar berbentuk bulatan */
#togg {
    width: 50px;
    height: 50px;
    background: #007bff;
    border-radius: 50%;
    color: #fff;
    text-align: center;
    line-height: 50px;
    font-size: 20px;
    cursor: pointer;
    position: fixed;
   bottom: 0 ;
   right: 0;
    z-index: 10000;
    transition: background 0.3s;
  
}

#togg:hover {
    background: #0056b3;
}

/* Mencegah iframe menutupi toolbar saat dragging */
#output {
    width: 100%;
    height: 100%;
    border: none;
    position: relative;
    z-index: 1;
}


/* Saat toolbar aktif */
.toolbar-container.show {
    opacity: 1;
    visibility: visible;
}




      
        #editorContainer, #outputContainer {
            width: 100%;
            height: 100vh;
            display: flex;
          position: relative;
    z-index: 1;
        }
      
/* Tampilan "View All" untuk layar besar (laptop/PC) */
.view-all #editorContainer,
.view-all #outputContainer {
    display: flex;
    width: 50%;
    height: 100vh;
}

.view-all {
    display: flex;
    flex-direction: row;
}

/* Tampilan "View All" untuk mobile */
@media (max-width: 768px) {
    .view-all {
        flex-direction: column;
    }
    
    .view-all #editorContainer,
    .view-all #outputContainer {
        width: 100%;
        height: 50vh;
    }
}
        #editor, iframe {
            width: 100%;
            height: 100vh;
            border: none;
              position: relative;
    z-index: 1;
        }

        .dark-mode { background-color: #282c34 !important;color: white; }
        textarea { display: none; }
    </style>
</head>
<body class="bg-light">

    <!-- Tombol Toggle Toolbar -->
    <div id="togg" class="toggle-toolbar" >â˜°</div>

    <!-- Toolbar -->
    <div id="toolbar_container" class="toolbar-container">
        <button id="toggleView" class="btn btn-info w-100 mb-2">Lihat Blok</button>
        <button id="runCode" class="btn btn-primary w-100 mb-2">Run</button>
        <button id="saveCode" class="btn btn-success w-100 mb-2">Save</button>
        <button id="loadCode" class="btn btn-warning w-100 mb-2">Load</button>
        <button id="toggleDarkMode" class="btn btn-dark w-100">Dark Mode</button>
<button id="undoCode" class="btn btn-secondary w-100 mb-2">Undo</button>
<button id="redoCode" class="btn btn-secondary w-100 mb-2">Redo</button>
<button id="viewAll" class="btn btn-secondary w-100 mb-2">View All</button>

    </div>

    <div id="editorContainer">
        <textarea id="hiddenCode">
     &lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;script src=&quot;https://sabdaliterasi.xyz/wp-content/cdn/n/jquery/3.7.1/dist/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  
  
 &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;p&gt;If you click on me, I will disappear.&lt;/p&gt;
&lt;p&gt;Click me away!&lt;/p&gt;
&lt;p&gt;Click me too!&lt;/p&gt;
&lt;script&gt;
!function(){
document.getElementById(&quot;demo&quot;);
document.getElementsByClassName(&quot;example&quot;);
document.querySelector(&quot;p&quot;);
document.querySelectorAll(&quot;p&quot;);
document.getElementsByTagName(&quot;li&quot;)
}()
&lt;/script&gt;
  
  &lt;script&gt;
    
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
        </textarea>
        <div id="editor"></div>
    </div>

    <div id="outputContainer" style="display: none;">
        <iframe id="output"></iframe>
    </div>

    <script type="module">
      
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
        import { getDatabase, ref, set, get } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js";

        // Firebase Config
        const firebaseConfig = {
    apiKey: "AIzaSyAFuoVF8LkEtVHtd33A0FJHIyIOhDzGbjA",
    authDomain: "sabaliterasipalu.firebaseapp.com",
    databaseURL: "https://sabaliterasipalu-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "sabaliterasipalu",
    storageBucket: "sabaliterasipalu.appspot.com",
    messagingSenderId: "567229920099",
    appId: "1:567229920099:web:636ca97b7ee332b342d956",
    measurementId: "G-7W6SD9QBY7"
  };
let isViewAllMode = false;
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // CodeMirror Setup
        const {EditorView, basicSetup}= CM["codemirror"]
const {html} = CM["@codemirror/lang-html"]
const { oneDark } = CM["@codemirror/theme-one-dark"];
const { StateEffect,EditorState } = CM["@codemirror/state"];
const { keymap,lineNumbers, EditorView: { lineWrapping } } = CM["@codemirror/view"];
     const { undo, redo,history } = CM["@codemirror/commands"];

const customKeymap = keymap.of([
    { key: "Mod-z", run: undo },  // Ctrl + Z untuk undo
    { key: "Mod-Shift-z", run: redo },  
]);
const themeEffect = StateEffect.define();


        let hiddenTextarea = document.getElementById("hiddenCode");

        let editor = new EditorView({
            parent: document.getElementById("editor"),
           state: EditorState.create({
            doc: hiddenTextarea.value,
            extensions: [
                basicSetup, 
                html(),
                lineWrapping,
                customKeymap,
                  history()
            ]
        })
        });
if (localStorage.getItem("darkMode") === "enabled") {
    document.body.classList.add("dark-mode");
   editor.dispatch({
        effects: StateEffect.reconfigure.of([ basicSetup, 
                html(),
                lineWrapping,
                customKeymap,
               history(),
                                              
              oneDark])
    });
}
        // Sinkronisasi CodeMirror dengan textarea
      function escapeHTML(html) {
    return html.replace(/&/g, "&amp;")
               .replace(/</g, "&lt;")
               .replace(/>/g, "&gt;");
}
      function unescapeHTML(html) {
    return html.replace(/&lt;/g, "<")
               .replace(/&gt;/g, ">")
               .replace(/&amp;/g, "&");
}
        function syncTextarea() {
        const edit=editor.state.doc.toString();
           $("#hiddenCode").text(escapeHTML(edit));
        }


      $(editor.dom).on("click change keyup", function(event) {
   syncTextarea() 
});
      
        editor.dispatch({
            changes: { from: 0, to: editor.state.doc.length, insert: unescapeHTML(hiddenTextarea.value) }
        });


      

     document.body.addEventListener("click", function(event) {
    const toolbar = document.querySelector(".toolbar-container");
    const toggler = document.getElementById("togg");

    // Cek jika toolbar sedang terbuka dan kliknya bukan di dalam toolbar atau tombol toggler
    if (toolbar.classList.contains("show") && !toolbar.contains(event.target) && event.target !== toggler) {
        toolbar.classList.remove("show");
    }
});


        // Toggle View Editor <-> Output
        document.getElementById("toggleView").addEventListener("click", function() {
            const editorContainer = document.getElementById("editorContainer");
            const outputContainer = document.getElementById("outputContainer");
            if (editorContainer.style.display === "none") {
                editorContainer.style.display = "flex";
                outputContainer.style.display = "none";
            } else {
                editorContainer.style.display = "none";
                outputContainer.style.display = "flex";
            }
        });

        // Run Code
document.getElementById("runCode").addEventListener("click", function() {
    syncTextarea();
    const output = document.getElementById("output").contentWindow.document;
    output.open();
    output.write(unescapeHTML(hiddenTextarea.value));
    output.close();

    // Cek apakah sedang dalam mode "View All"
    if (document.body.classList.contains("view-all")) {
        // Dalam mode "View All", jangan sembunyikan editorContainer
        document.getElementById("outputContainer").style.display = "flex";
    } else {
        // Jika tidak dalam mode "View All", sembunyikan editorContainer
        document.getElementById("editorContainer").style.display = "none";
        document.getElementById("outputContainer").style.display = "flex";
    }

    $(".toolbar-container").fadeOut(200).removeClass("show");
    $(output).on("click", function (e) {
        if (!$(e.target).closest(".toolbar-container, #togg").length) {
            $(".toolbar-container").fadeOut(200).removeClass("show");
        }
    });
});

        // Save Code ke Firebase
        document.getElementById("saveCode").addEventListener("click", function() {
            syncTextarea();
            const code = editor.state.doc.toString();
            const codeRef = ref(db, "code");
            get(codeRef).then(snapshot => {
                if (snapshot.exists()) {
                    if (!confirm("Mau menimpa kode yang sudah ada?")) return;
                }
                set(codeRef, { content: code }).then(() => alert("Kode berhasil disimpan!"));
            });
        });

        // Load Code dari Firebase
        document.getElementById("loadCode").addEventListener("click", function() {
            get(ref(db, "code")).then(snapshot => {
                if (snapshot.exists()) {
                    editor.dispatch({
                        changes: { from: 0, to: editor.state.doc.length, insert: snapshot.val().content }
                    });
                    hiddenTextarea.value = snapshot.val().content;
                } else {
                    alert("Tidak ada kode tersimpan.");
                }
            });
        });

        // Dark Mode
        document.getElementById("toggleDarkMode").addEventListener("click", function() {
    document.body.classList.toggle("dark-mode");

    let isDark = document.body.classList.contains("dark-mode");

   editor.dispatch({
        effects: StateEffect.reconfigure.of(isDark ? [ basicSetup, 
                html(),
                lineWrapping,
                customKeymap,
                  history(),oneDark] : [ basicSetup, 
                html(),
                lineWrapping,
                customKeymap,
                  history()])
    });
        isDark?localStorage.setItem("darkMode", "enabled"):localStorage.setItem("darkMode", "disabled");
    
  $(editor.dom).on("click change keyup",function(event) {
   syncTextarea() 
});
      
   

});




// Event Listener untuk Undo
document.getElementById("undoCode").addEventListener("click", function() {
    undo(editor); syncTextarea() 
});

// Event Listener untuk Redo
document.getElementById("redoCode").addEventListener("click", function() {
    redo(editor); syncTextarea() 
});

    
$(document).ready(function () {
    let isDragging = false;
    let dragTimeout;

    function makeDraggable(element) {
        let offsetX, offsetY, startY;

        $(element).on("pointerdown", function (e) {
            isDragging = false;
            let el = $(this);
            let elOffset = el.offset();

            offsetX = e.clientX - elOffset.left;
            offsetY = e.clientY - elOffset.top;
            startY = elOffset.top;

            // Matikan event di iframe agar tidak mengganggu drag
            $("#output").css("pointer-events", "none");

            $(document).on("pointermove", function (e) {
                isDragging = true;

                let newX = e.clientX - offsetX;
                let newY = e.clientY - offsetY;

                // Batas layar agar elemen tidak keluar dari viewport
                newX = Math.max(0, Math.min($(window).width() - el.outerWidth(), newX));
                newY = Math.max(50, Math.min($(window).height() - el.outerHeight() - 20, newY));

                el.css({ left: newX + "px", top: newY + "px", position: "fixed" });
            });

            $(document).on("pointerup", function () {
                $(document).off("pointermove pointerup");
                clearTimeout(dragTimeout);
                dragTimeout = setTimeout(() => (isDragging = false), 100);

                // Aktifkan kembali event di iframe
                $("#output").css("pointer-events", "auto");
            });
        });
    }

    // Terapkan draggable ke toolbar & tombol toggle
    makeDraggable(".toolbar-container");
    makeDraggable("#togg");

    // Toggle toolbar saat tombol toggle diklik
    $("#togg").on("click", function () {
        if (!isDragging) {
            $(".toolbar-container").fadeToggle(200).toggleClass("show");
        }
    });

    // Klik di luar toolbar = sembunyikan
    $(document).on("click", function (e) {
        if (!$(e.target).closest(".toolbar-container, #togg").length) {
            $(".toolbar-container").fadeOut(200).removeClass("show");
        }
    });

  

    // Pastikan tombol dalam toolbar bisa diklik tanpa terganggu
    $(".toolbar-container button").on("click", function (e) {
        e.stopPropagation();
    });
});


document.getElementById("viewAll").addEventListener("click", function () {
    const editorContainer = document.getElementById("editorContainer");
    const outputContainer = document.getElementById("outputContainer");
    const body = document.body;

    if (body.classList.contains("view-all")) {
        // Kembali ke tampilan default
        body.classList.remove("view-all");
        editorContainer.style.display = "flex";
        outputContainer.style.display = "none";
    } else {
        // Aktifkan tampilan View All
        body.classList.add("view-all");
        editorContainer.style.display = "flex";
        outputContainer.style.display = "flex";
    }
});

    </script>

</body>
</html>
